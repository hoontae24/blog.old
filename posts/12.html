<!DOCTYPE html>
<html>
<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <title>
    리액트 컴포넌트 Rerendering 파헤치기 | 코드블로그
    
  </title>
  <meta name="description" content="React는 웹 프론트엔드 라이브러리로 많이 사용되어지고 있습니다. 저 역시 리액트를 처음 접하고 업무 프로젝트로 사용한 지 1년 정도가 되었습니다. 라이브러리를 이용하여 개발을 하면 더 편하지만 알아야 할 것도 많이 생깁니다.">
  <!-- Begin Jekyll SEO tag v2.6.1 -->
<meta name="generator" content="Jekyll v4.0.0" />
<meta property="og:title" content="리액트 컴포넌트 Rerendering 파헤치기" />
<meta name="author" content="Hoontae" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="React는 웹 프론트엔드 라이브러리로 많이 사용되어지고 있습니다. 저 역시 리액트를 처음 접하고 업무 프로젝트로 사용한 지 1년 정도가 되었습니다. 라이브러리를 이용하여 개발을 하면 더 편하지만 알아야 할 것도 많이 생깁니다." />
<meta property="og:description" content="React는 웹 프론트엔드 라이브러리로 많이 사용되어지고 있습니다. 저 역시 리액트를 처음 접하고 업무 프로젝트로 사용한 지 1년 정도가 되었습니다. 라이브러리를 이용하여 개발을 하면 더 편하지만 알아야 할 것도 많이 생깁니다." />
<link rel="canonical" href="https://hoontae24.github.io/posts/12" />
<meta property="og:url" content="https://hoontae24.github.io/posts/12" />
<meta property="og:site_name" content="코드블로그" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-03-15T00:00:00+09:00" />
<script type="application/ld+json">
{"headline":"리액트 컴포넌트 Rerendering 파헤치기","dateModified":"2020-03-15T00:00:00+09:00","datePublished":"2020-03-15T00:00:00+09:00","url":"https://hoontae24.github.io/posts/12","mainEntityOfPage":{"@type":"WebPage","@id":"https://hoontae24.github.io/posts/12"},"author":{"@type":"Person","name":"Hoontae"},"description":"React는 웹 프론트엔드 라이브러리로 많이 사용되어지고 있습니다. 저 역시 리액트를 처음 접하고 업무 프로젝트로 사용한 지 1년 정도가 되었습니다. 라이브러리를 이용하여 개발을 하면 더 편하지만 알아야 할 것도 많이 생깁니다.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>
  <link rel='stylesheet' href='//cdn.jsdelivr.net/npm/hack-font@3.3.0/build/web/hack.css'>
  <link href="https://fonts.googleapis.com/css?family=Lato:300,300i,400,400i&display=swap" rel="stylesheet">
  
  <link rel="stylesheet" href="/assets/vendor/bootstrap/css/bootstrap.min.css">

  <link rel="stylesheet" href="/assets/vendor/fontawesome-free/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/syntax.css">

  <link href="/img/ico/favicon.ico" rel="shortcut icon" type="image/vnd.microsoft.icon"/>

  <link rel="stylesheet" href="/assets/main.css">
  <link rel="canonical" href="https://hoontae24.github.io/posts/12">
  <link rel="alternate" type="application/rss+xml" title="코드블로그" href="/feed.xml">

</head>

<script>
  const listeners = []
  const onMount = listener => listeners.push(listener)
  window.addEventListener('load', () => {
    listeners.forEach(listener => listener && listener())
  })
</script>

<body>
  <!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="navbar-wrapper">
    <a class="navbar-brand" href="/" >
      코드블로그
    </a>
    <button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
  </div>
  <div class="collapse navbar-collapse" id="navbarResponsive">
    <ul class="navbar-nav ml-auto">
      <!-- <li class="nav-item">
        <a class="nav-link" href="/">HOME</a>
      </li> -->
      <li class="nav-item">
        <a class="nav-link" href="/posts">POSTS</a>
      </li>
      <!-- <li class="nav-item">
          <a class="nav-link" href="/tags">TAGS</a>
      </li> -->
      <li class="nav-item">
          <a class="nav-link" href="/archives">ARCHIVES</a>
      </li>
      <li class="nav-item">
          <a class="nav-link" href="/about">ABOUT</a>
      </li>
    </ul>
  </div>
</nav>


  <!-- Page Header -->

<header
  class="masthead"
  style="background-image: url('/img/resources/react_render_props.png')"
>
  
    <div class="overlay"></div>
    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-md-10 mx-auto">
          <div class="post-heading">
            <h1>리액트 컴포넌트 Rerendering 파헤치기</h1>
            
            <span class="meta">
              <!-- >Posted by
              <a href="/about"
                >Hoontae</a
              >
              on  -->
              2020.03.15 &middot; <span class="reading-time" title="Estimated read time">
  
   20 mins  read </span>

            </span>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="container post">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto wrapper">
        

<script>
  const btnFolded = document.querySelector('.btn.folded')
  const btnUnfolded = document.querySelector('.btn.unfolded')
  btnFolded && btnFolded.classList.add('hidden')
  btnUnfolded && btnUnfolded.classList.remove('hidden')  

  function toggleFold () {
    const btnFolded = document.querySelector('.btn.folded')
    const btnUnfolded = document.querySelector('.btn.unfolded')
    const titleWrapper = document.querySelector('.title-wrapper')
    const itemWrapper = document.querySelector('.item-wrapper')
    btnFolded.classList.toggle('hidden')
    btnUnfolded.classList.toggle('hidden')
    titleWrapper.classList.toggle('folded')
    itemWrapper.classList.toggle('folded')
  }
</script>
 <p>React는 웹 프론트엔드 라이브러리로 많이 사용되어지고 있습니다. 저 역시 리액트를 처음 접하고 업무 프로젝트로 사용한 지 1년 정도가 되었습니다. 라이브러리를 이용하여 개발을 하면 더 편하지만 알아야 할 것도 많이 생깁니다.</p>

<p>리액트로 개발을 할 때, 컴포넌트의 <strong>Rerendering</strong>에 대해 고민하게 될 때가 있는데요. React는 화면의 변경 사항에 대해서 ReactDOM을 이용하여 변경된 부분에 대해서만 Rerendering(또는 Update)합니다. React의 <a href="https://ko.reactjs.org/docs/react-component.html#the-component-lifecycle">Lifecycle</a>을 이해하면 Rerendering을 잘 고려해서 개발할 수 있습니다.</p>

<p>오늘은 간단한 Phonebook을 구현하면서, ReactDOM의 업데이트를 관찰하고, 컴포넌트의 Rerendering에 대해서 살펴보겠습니다. 특히 불필요한 업데이트를 줄이는 방법에 대해 중점적으로 보려고 합니다.</p>

<hr />

<h3 id="0-개발-환경-구성하기">0. 개발 환경 구성하기</h3>

<p>오늘 실습 개발 환경을 위해서 다음 두 가지가 필요합니다.</p>

<ol>
  <li><a href="https://github.com/facebook/create-react-app">CRA(create-react-app)</a></li>
  <li><a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi">chrome 확장프로그램 React Developer Tools</a></li>
</ol>

<p>먼저 CRA를 이용하여 간단한 React App을 만듭니다. 그리고 실습에 사용될 몇가지 패키지를 설치하겠습니다.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>npx create-react-app react-rerendering-test
<span class="nv">$ </span><span class="nb">cd </span>react-rerendering-test
<span class="nv">$ </span>npm i lodash random-name @material-ui/core
</code></pre></div></div>

<p><code class="highlighter-rouge">lodash</code>와 <code class="highlighter-rouge">random-name</code>은 샘플 데이터를 다루기 위해서 설치합니다. <code class="highlighter-rouge">@material-ui</code>는 <code class="highlighter-rouge">input</code>태그를 대신하여 사용할 <code class="highlighter-rouge">TextField</code>를 위해 설치합니다. 또한 실제 업무에서도 html 태그가 아닌 UI 라이브러리의 컴포넌트를 사용하는 경우가 많으니 실습에 더 도움이 될 것이라 생각합니다.</p>

<p><code class="highlighter-rouge">App.js</code>에 템플릿으로 작성되어있는 내용을 모두 지우고 다음과 같이 작성하겠습니다.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/App.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">PhoneBook</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./components/phone-book</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">App</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className=</span><span class="s2">"App"</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nt">div</span>
        <span class="na">style=</span><span class="si">{</span> <span class="p">{</span>
          <span class="na">backgroundColor</span><span class="p">:</span> <span class="dl">"</span><span class="s2">steelblue</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">color</span><span class="p">:</span> <span class="dl">"</span><span class="s2">white</span><span class="dl">"</span><span class="p">,</span>
          <span class="na">marginBottom</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
        <span class="p">}</span> <span class="si">}</span>
      <span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h1</span>
          <span class="na">style=</span><span class="si">{</span> <span class="p">{</span>
            <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">auto</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">width</span><span class="p">:</span> <span class="dl">"</span><span class="s2">fit-content</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">height</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>
            <span class="na">display</span><span class="p">:</span> <span class="dl">"</span><span class="s2">flex</span><span class="dl">"</span><span class="p">,</span>
            <span class="na">alignItems</span><span class="p">:</span> <span class="dl">"</span><span class="s2">center</span><span class="dl">"</span><span class="p">,</span>
          <span class="p">}</span> <span class="si">}</span>
        <span class="p">&gt;</span>
          HELLO REACT RENDER
        <span class="p">&lt;/</span><span class="nt">h1</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">PhoneBook</span> <span class="p">/&gt;</span>
    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>그리고 <code class="highlighter-rouge">src</code>폴더 아래에 <code class="highlighter-rouge">components</code>폴더를 만들고 <code class="highlighter-rouge">phone-book.js</code>파일을 다음과 같이 작성합니다.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/components/phone-book.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">lodash</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">randomName</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">random-name</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">withStyles</span><span class="p">,</span> <span class="nx">Grid</span><span class="p">,</span> <span class="nx">TextField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@material-ui/core</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">randomNumber</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">String</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">));</span>
<span class="kd">const</span> <span class="nx">randomPhone</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="s2">`010-xxxx-xxxx`</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/x/g</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">randomNumber</span><span class="p">());</span>

<span class="kd">const</span> <span class="nx">memberCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">members</span> <span class="o">=</span> <span class="nx">lodash</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">memberCount</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">i</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="na">id</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="nx">randomName</span><span class="p">(),</span> <span class="na">phone</span><span class="p">:</span> <span class="nx">randomPhone</span><span class="p">()</span> <span class="p">}));</span>

<span class="kd">class</span> <span class="nx">PhoneBook</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">members</span> <span class="p">};</span>

  <span class="nx">handleChange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span>
      <span class="na">dataset</span><span class="p">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">},</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">field</span><span class="p">,</span>
      <span class="nx">value</span><span class="p">,</span>
    <span class="p">}</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">members</span> <span class="o">=</span> <span class="p">[...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">members</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">members</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">(</span><span class="nx">member</span> <span class="o">=&gt;</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
    <span class="nx">members</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">members</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="p">[</span><span class="nx">field</span><span class="p">]:</span> <span class="nx">value</span> <span class="p">};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">members</span><span class="p">:</span> <span class="p">[...</span><span class="nx">members</span><span class="p">]</span> <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">classes</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">members</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className=</span><span class="si">{</span><span class="nx">classes</span><span class="p">.</span><span class="nx">root</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>PhoneBook<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="nx">members</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">member</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="p">&lt;</span><span class="nc">Grid</span>
            <span class="na">key=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span>
            <span class="nt">container</span>
            <span class="na">spacing=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span>
            <span class="na">className=</span><span class="si">{</span><span class="nx">classes</span><span class="p">.</span><span class="nx">row</span><span class="si">}</span>
            <span class="na">alignItems=</span><span class="s2">"center"</span>
          <span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="p">&gt;</span>
              <span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span>
            <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
              <span class="p">&lt;</span><span class="nc">TextField</span>
                <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
                <span class="na">label=</span><span class="s2">"name"</span>
                <span class="na">name=</span><span class="s2">"name"</span>
                <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span>
                <span class="na">onChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="si">}</span>
              <span class="p">/&gt;</span>
            <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
            <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
              <span class="p">&lt;</span><span class="nc">TextField</span>
                <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
                <span class="na">label=</span><span class="s2">"phone"</span>
                <span class="na">name=</span><span class="s2">"phone"</span>
                <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">phone</span><span class="si">}</span>
                <span class="na">onChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="si">}</span>
              <span class="p">/&gt;</span>
            <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
          <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
        <span class="p">))</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">root</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0 200px</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">row</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">margin</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">withStyles</span><span class="p">(</span><span class="nx">styles</span><span class="p">)(</span><span class="nx">PhoneBook</span><span class="p">);</span>

</code></pre></div></div>

<p>이제 개발 서버를 실행해보겠습니다. 콘솔에서 <code class="highlighter-rouge">npm run start</code>로 시작해주세요. 다음과 같은 화면이 표시됩니다. <code class="highlighter-rouge">input</code>의 값도 잘 변경 됩니다.</p>

<p><img src="/img/posts/react/react-rerendering-test_1.png" alt="screenshot" /></p>

<p>이제 컴포넌트의 변경(Rerendering)을 관찰할 수 있도록 React Developer Tools를 설치하겠습니다.</p>

<p><img src="/img/posts/react/react-developer-tools.png" alt="react developer tools" /></p>

<p>이제 크롬의 개발자 도구를 열고, <code class="highlighter-rouge">Profiler</code>탭에서 <code class="highlighter-rouge">톱니바퀴 모양(view settings)</code>을 누르고 <code class="highlighter-rouge">Highlight updates when components render</code>옵션을 켜줍니다.</p>

<p><img src="/img/posts/react/react-rerendering-test_2.gif" alt="screenshot" /></p>

<p>컴포넌트가 새로 그려질 때 마다 브라우저에 표시됩니다.</p>

<hr />

<h3 id="1-컴포넌트-rerendering-살펴보기">1. 컴포넌트 Rerendering 살펴보기</h3>

<p><code class="highlighter-rouge">PhoneBook</code> 컴포넌트를 살펴보겠습니다. <code class="highlighter-rouge">members</code> 배열을 <code class="highlighter-rouge">map</code>을 통해서 바로 렌더링하고 있습니다. 하나의 <code class="highlighter-rouge">TextField</code>에서 값을 변경하면 모든 <code class="highlighter-rouge">TextField</code>가 리렌더링 되는 것을 볼 수 있습니다. 그리고 타이핑을 할 때마다 모든 <code class="highlighter-rouge">TextField</code>가 리렌더링하느라 버벅임이 발생합니다. <code class="highlighter-rouge">setState</code>에서 <code class="highlighter-rouge">members</code>의 값을 변경하면 <code class="highlighter-rouge">PhoneBook</code> 컴포넌트가 업데이트 되기 때문에 자식 컴포넌트도 업데이트 되는 것입니다. 현재는 10개의 <code class="highlighter-rouge">member</code>가 있지만 늘어날 수록 더욱 느려질 것입니다.</p>

<hr />

<h3 id="2-자식-컴포넌트-분리하기">2. 자식 컴포넌트 분리하기</h3>

<p>하나의 <code class="highlighter-rouge">TextField</code>가 업데이트 될 때, 다른 컴포넌트는 업데이트 될 필요가 없습니다. 자식 컴포넌트로 분리해서 따로 동작하도록 만들어 보겠습니다.</p>

<p>각 Member 단위로 컴포넌트로 구현하겠습니다. <code class="highlighter-rouge">src/components</code>폴더에 <code class="highlighter-rouge">form.js</code>파일을 만들고 다음과 같이 작성하겠습니다.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/components/form.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">withStyles</span><span class="p">,</span> <span class="nx">TextField</span><span class="p">,</span> <span class="nx">Grid</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@material-ui/core</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">form</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">padding</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="na">border</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid lightgray</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="kd">class</span> <span class="nx">Form</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">PureComponent</span> <span class="p">{</span>
  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">classes</span><span class="p">,</span> <span class="nx">member</span><span class="p">,</span> <span class="nx">onChange</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">container</span> <span class="na">spacing=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span> <span class="na">className=</span><span class="si">{</span><span class="nx">classes</span><span class="p">.</span><span class="nx">form</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="p">&gt;</span>
          <span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span>
        <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nc">TextField</span>
            <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
            <span class="na">name=</span><span class="s2">"name"</span>
            <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span>
            <span class="na">onChange=</span><span class="si">{</span><span class="nx">onChange</span><span class="si">}</span>
          <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
          <span class="p">&lt;</span><span class="nc">TextField</span>
            <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
            <span class="na">name=</span><span class="s2">"phone"</span>
            <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">phone</span><span class="si">}</span>
            <span class="na">onChange=</span><span class="si">{</span><span class="nx">onChange</span><span class="si">}</span>
          <span class="p">/&gt;</span>
        <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">withStyles</span><span class="p">(</span><span class="nx">styles</span><span class="p">)(</span><span class="nx">Form</span><span class="p">);</span>
</code></pre></div></div>

<p>이제 <code class="highlighter-rouge">phone-book.js</code>파일을 수정해줍니다.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/components/phone-book.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">lodash</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">lodash</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">randomName</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">random-name</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">withStyles</span><span class="p">,</span> <span class="nx">Grid</span><span class="p">,</span> <span class="nx">TextField</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@material-ui/core</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="nx">Form</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">./form</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">randomNumber</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nb">String</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">((</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span> <span class="o">%</span> <span class="mi">10</span><span class="p">));</span>
<span class="kd">const</span> <span class="nx">randomPhone</span> <span class="o">=</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="s2">`010-xxxx-xxxx`</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/x/g</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="nx">randomNumber</span><span class="p">());</span>

<span class="kd">const</span> <span class="nx">memberCount</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">members</span> <span class="o">=</span> <span class="nx">lodash</span>
  <span class="p">.</span><span class="nx">range</span><span class="p">(</span><span class="nx">memberCount</span><span class="p">)</span>
  <span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">i</span> <span class="o">=&gt;</span> <span class="p">({</span> <span class="na">id</span><span class="p">:</span> <span class="nx">i</span><span class="p">,</span> <span class="na">name</span><span class="p">:</span> <span class="nx">randomName</span><span class="p">(),</span> <span class="na">phone</span><span class="p">:</span> <span class="nx">randomPhone</span><span class="p">()</span> <span class="p">}));</span>

<span class="kd">class</span> <span class="nx">PhoneBook</span> <span class="kd">extends</span> <span class="nx">React</span><span class="p">.</span><span class="nx">Component</span> <span class="p">{</span>
  <span class="nx">state</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">members</span> <span class="p">};</span>

  <span class="nx">handleChange</span> <span class="o">=</span> <span class="nx">e</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span>
      <span class="na">dataset</span><span class="p">:</span> <span class="p">{</span> <span class="nx">id</span> <span class="p">},</span>
      <span class="na">name</span><span class="p">:</span> <span class="nx">field</span><span class="p">,</span>
      <span class="nx">value</span><span class="p">,</span>
    <span class="p">}</span> <span class="o">=</span> <span class="nx">e</span><span class="p">.</span><span class="nx">target</span><span class="p">;</span>

    <span class="kd">const</span> <span class="nx">members</span> <span class="o">=</span> <span class="p">[...</span><span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">.</span><span class="nx">members</span><span class="p">];</span>
    <span class="kd">const</span> <span class="nx">index</span> <span class="o">=</span> <span class="nx">members</span><span class="p">.</span><span class="nx">findIndex</span><span class="p">(</span><span class="nx">member</span> <span class="o">=&gt;</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="o">===</span> <span class="nb">Number</span><span class="p">(</span><span class="nx">id</span><span class="p">));</span>
    <span class="nx">members</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="p">...</span><span class="nx">members</span><span class="p">[</span><span class="nx">index</span><span class="p">],</span> <span class="p">[</span><span class="nx">field</span><span class="p">]:</span> <span class="nx">value</span> <span class="p">};</span>

    <span class="k">this</span><span class="p">.</span><span class="nx">setState</span><span class="p">({</span> <span class="na">members</span><span class="p">:</span> <span class="p">[...</span><span class="nx">members</span><span class="p">]</span> <span class="p">});</span>
  <span class="p">};</span>

  <span class="nx">render</span><span class="p">()</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">classes</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">props</span><span class="p">;</span>
    <span class="kd">const</span> <span class="p">{</span> <span class="nx">members</span> <span class="p">}</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">state</span><span class="p">;</span>
    <span class="k">return</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nt">div</span> <span class="na">className=</span><span class="si">{</span><span class="nx">classes</span><span class="p">.</span><span class="nx">root</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nt">h2</span><span class="p">&gt;</span>PhoneBook<span class="p">&lt;/</span><span class="nt">h2</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="nx">members</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">member</span> <span class="o">=&gt;</span> <span class="p">(</span>
          <span class="p">&lt;</span><span class="nc">Form</span> <span class="na">key=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span> <span class="na">member=</span><span class="si">{</span><span class="nx">member</span><span class="si">}</span> <span class="na">onChange=</span><span class="si">{</span><span class="k">this</span><span class="p">.</span><span class="nx">handleChange</span><span class="si">}</span> <span class="p">/&gt;</span>
        <span class="p">))</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
    <span class="p">);</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">root</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">margin</span><span class="p">:</span> <span class="dl">"</span><span class="s2">0 200px</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
  <span class="na">row</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">margin</span><span class="p">:</span> <span class="mi">16</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">withStyles</span><span class="p">(</span><span class="nx">styles</span><span class="p">)(</span><span class="nx">PhoneBook</span><span class="p">);</span>
</code></pre></div></div>

<p>각 Member를 그리는 부분을 컴포넌트로 분리했습니다. 그리고 자식 컴포넌트로 사용되는 <code class="highlighter-rouge">Form</code>컴포넌트는 <code class="highlighter-rouge">PureComponent</code>를 상속받은 컴포넌트입니다. 한번 실행해보겠습니다.</p>

<p><img src="/img/posts/react/react-rerendering-test_3.gif" alt="screenshot" /></p>

<p><code class="highlighter-rouge">TextField</code>에 입력을 하면 <code class="highlighter-rouge">PhoneBook</code>컴포넌트가 업데이트 됩니다. 하지만 자식 컴포넌트인 <code class="highlighter-rouge">Form</code>컴포넌트는 <code class="highlighter-rouge">props</code>가 변하는 컴포넌트만 리렌더링이 발생합니다. 버벅임도 사라졌습니다.</p>

<hr />

<h3 id="3-reactmemo-사용하기">3. React.memo 사용하기</h3>

<p><code class="highlighter-rouge">Form</code>컴포넌트를 <code class="highlighter-rouge">PureComponent</code>를 사용하지 않는다면 어떻게 할 수 있을까요? <code class="highlighter-rouge">Form</code>컴포넌트를 함수형 컴포넌트로 수정해 보겠습니다. 그리고 컴포넌트를 <code class="highlighter-rouge">React.memo</code>함수로 전달해줍니다.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/components/form.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">withStyles</span><span class="p">,</span> <span class="nx">TextField</span><span class="p">,</span> <span class="nx">Grid</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@material-ui/core</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">form</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">padding</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="na">border</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid lightgray</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">Form</span> <span class="o">=</span> <span class="nx">props</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">classes</span><span class="p">,</span> <span class="nx">member</span><span class="p">,</span> <span class="nx">onChange</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>
  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">container</span> <span class="na">spacing=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span> <span class="na">className=</span><span class="si">{</span><span class="nx">classes</span><span class="p">.</span><span class="nx">form</span><span class="si">}</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">TextField</span>
          <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
          <span class="na">name=</span><span class="s2">"name"</span>
          <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span>
          <span class="na">onChange=</span><span class="si">{</span><span class="nx">onChange</span><span class="si">}</span>
        <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="p">&lt;</span><span class="nc">TextField</span>
          <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
          <span class="na">name=</span><span class="s2">"phone"</span>
          <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">phone</span><span class="si">}</span>
          <span class="na">onChange=</span><span class="si">{</span><span class="nx">onChange</span><span class="si">}</span>
        <span class="p">/&gt;</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">withStyles</span><span class="p">(</span><span class="nx">styles</span><span class="p">)(</span><span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">(</span><span class="nx">Form</span><span class="p">));</span>
</code></pre></div></div>

<p>이렇게 하면 <code class="highlighter-rouge">PureComponent</code>를 사용하는 것과 같은 효과를 가지게 됩니다. 상태를 가지지 않는 <code class="highlighter-rouge">Form</code>컴포넌트의 경우에는 함수형 컴포넌트가 작성하기도 쉽고 직관적으로 코드를 작성/파악할 수 있습니다.</p>

<hr />

<h3 id="4-세부-컴포넌트-분리하기">4. 세부 컴포넌트 분리하기</h3>

<p><code class="highlighter-rouge">Form</code>컴포넌트로 분리했지만 아직 그 안에 두 개의 <code class="highlighter-rouge">TextField</code>가 있습니다. 지금은 두 개이지만 몇 개가 될 지 보장할 수 없습니다. 그렇다고 <code class="highlighter-rouge">TextField</code>를 또 다른 컴포넌트로 작성하면 번거로울 수 있습니다. 따로 컴포넌트로 분리하지 않고 <code class="highlighter-rouge">TextField</code>가 각각의 업데이트에 독립적으로 동작하도록 만들어 봅시다.</p>

<p><code class="highlighter-rouge">React.useMemo</code>를 이용하여 코드를 분리시켜보겠습니다. <code class="highlighter-rouge">form.js</code>를 다음과 같이 수정하겠습니다.</p>

<div class="language-jsx highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// src/components/form.js</span>
<span class="k">import</span> <span class="nx">React</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">react</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">withStyles</span><span class="p">,</span> <span class="nx">TextField</span><span class="p">,</span> <span class="nx">Grid</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">@material-ui/core</span><span class="dl">"</span><span class="p">;</span>

<span class="kd">const</span> <span class="nx">styles</span> <span class="o">=</span> <span class="p">{</span>
  <span class="na">form</span><span class="p">:</span> <span class="p">{</span>
    <span class="na">padding</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
    <span class="na">border</span><span class="p">:</span> <span class="dl">"</span><span class="s2">1px solid lightgray</span><span class="dl">"</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">};</span>

<span class="kd">const</span> <span class="nx">Form</span> <span class="o">=</span> <span class="nx">props</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="p">{</span> <span class="nx">classes</span><span class="p">,</span> <span class="nx">member</span><span class="p">,</span> <span class="nx">onChange</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">props</span><span class="p">;</span>

  <span class="kd">const</span> <span class="nx">nameField</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">useMemo</span><span class="p">(</span>
    <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nc">TextField</span>
        <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
        <span class="na">name=</span><span class="s2">"name"</span>
        <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">name</span><span class="si">}</span>
        <span class="na">onChange=</span><span class="si">{</span><span class="nx">onChange</span><span class="si">}</span>
      <span class="p">/&gt;</span>
    <span class="p">),</span>
    <span class="p">[</span><span class="nx">member</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span>
  <span class="p">);</span>

  <span class="kd">const</span> <span class="nx">phoneField</span> <span class="o">=</span> <span class="nx">React</span><span class="p">.</span><span class="nx">useMemo</span><span class="p">(</span>
    <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">(</span>
      <span class="p">&lt;</span><span class="nc">TextField</span>
        <span class="na">inputProps=</span><span class="si">{</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">data-id</span><span class="dl">"</span><span class="p">:</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span> <span class="p">}</span> <span class="si">}</span>
        <span class="na">name=</span><span class="s2">"phone"</span>
        <span class="na">value=</span><span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">phone</span><span class="si">}</span>
        <span class="na">onChange=</span><span class="si">{</span><span class="nx">onChange</span><span class="si">}</span>
      <span class="p">/&gt;</span>
    <span class="p">),</span>
    <span class="p">[</span><span class="nx">member</span><span class="p">.</span><span class="nx">phone</span><span class="p">,</span> <span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="p">],</span>
  <span class="p">);</span>

  <span class="k">return</span> <span class="p">(</span>
    <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">container</span> <span class="na">spacing=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span> <span class="na">className=</span><span class="si">{</span><span class="nx">classes</span><span class="p">.</span><span class="nx">form</span><span class="si">}</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">2</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="nx">member</span><span class="p">.</span><span class="nx">id</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="nx">nameField</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
      <span class="p">&lt;</span><span class="nc">Grid</span> <span class="nt">item</span> <span class="na">xs=</span><span class="si">{</span><span class="mi">5</span><span class="si">}</span><span class="p">&gt;</span>
        <span class="si">{</span><span class="nx">phoneField</span><span class="si">}</span>
      <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
    <span class="p">&lt;/</span><span class="nc">Grid</span><span class="p">&gt;</span>
  <span class="p">);</span>
<span class="p">};</span>

<span class="k">export</span> <span class="k">default</span> <span class="nx">withStyles</span><span class="p">(</span><span class="nx">styles</span><span class="p">)(</span><span class="nx">React</span><span class="p">.</span><span class="nx">memo</span><span class="p">(</span><span class="nx">Form</span><span class="p">));</span>
</code></pre></div></div>

<p><code class="highlighter-rouge">TextField</code>를 사용하는 <code class="highlighter-rouge">name</code>과 <code class="highlighter-rouge">phone</code> 부분을 분리했습니다. <code class="highlighter-rouge">React.useMemo</code>를 이용하여 각각의 필드가 영향을 받는 값에 대해서만 업데이트 되도록 작성했습니다. 동작과 업데이트를 한번 보겠습니다.</p>

<p><img src="/img/posts/react/react-rerendering-test_4.gif" alt="screenshot" /></p>

<p>이제 <code class="highlighter-rouge">Form</code>컴포넌트 내에서도 각 <code class="highlighter-rouge">TextField</code>의 업데이트가 서로 영향을 주지 않습니다. 독립적으로 리렌더링 됩니다.</p>

<hr />

<h3 id="마무리">마무리</h3>

<p>오늘은 리액트 컴포넌트가 리렌더링 되는 것과 컴포넌트를 분리해서 불필요한 리렌더링을 방지하는 실습을 해봤습니다. 개발을 하다보면 컴포넌트가 커지고 복잡해질수록 불필요한 프로세스를 줄이고 성능 최적화를 구성하는 것이 어려워집니다. 작은 컴포넌트 단위부터 잘 구성하여서 성능 이슈를 발생시키지 않도록 하는 연습을 많이 해야할 것 같습니다.</p>

        <div class="post-bottom-margin"></div>
         




<span 
  class="tag tag-chip btn-route"
  path="/tags#React"
  title=""
>
  <span class="label">
      React
  </span>
  
</span>
  




<span 
  class="tag tag-chip btn-route"
  path="/tags#Frontend"
  title=""
>
  <span class="label">
      Frontend
  </span>
  
</span>
 
        <div class="post-bottom-margin"></div>

        <!-- <div class="clearfix">
          
          <a
            class="btn btn-primary float-left"
            href="/posts/11"
            data-toggle="tooltip"
            data-placement="bottom"
            title="자주 사용하는 Git 명령어 정리"
            >&larr; Previous<span class="d-none d-md-inline"> Post</span></a
          >
           
          <a
            class="btn btn-primary float-right"
            href="/posts/13"
            data-toggle="tooltip"
            data-placement="bottom"
            title="자바스크립트, 딕셔너리를 만드는 가장 빠른 방법은?"
            >Next<span class="d-none d-md-inline"> Post</span> &rarr;</a
          >
          
        </div> -->
      </div>
    </div>
  </div>
</header>


  <!-- Footer -->

<hr>

<footer>
  <div class="container">
    <div class="row">
      <div class="col-lg-8 col-md-10 mx-auto">
        <ul class="list-inline text-center">
          
          <li class="list-inline-item">
            <a href="mailto:kadr8941@gmail.com">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
          
          
          
          
          <li class="list-inline-item">
            <a href="https://github.com/hoontae24">
              <span class="fa-stack fa-lg">
                <i class="fas fa-circle fa-stack-2x"></i>
                <i class="fab fa-github fa-stack-1x fa-inverse"></i>
              </span>
            </a>
          </li>
          
        </ul>
        <p class="copyright text-muted">Copyright &copy; hoontae 2020</p>
      </div>
    </div>
  </div>
</footer>

  <script src="/assets/vendor/jquery/jquery.min.js"></script>
<script src="/assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
<script src="/assets/vendor/startbootstrap-clean-blog/js/clean-blog.min.js"></script>

<script src="/assets/scripts.js"></script>
<script src="/assets/js/post.js"></script>
<script src="/assets/js/global.js"></script>



  <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-151335869-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-151335869-1');
</script>


  <div class="scrollToTopButton" onclick="_toTop()">
  <i class="fas fa-arrow-up"></i>
</div>

<script>
  const _toTop = () => {
    const isHigh = window.scrollY > 2000
    window.scrollTo({
      top: 0,
      left: 0,
      behavior: isHigh ? 'auto' : 'smooth',
    })
  }
  onMount(() => {
    const btn = document.querySelector('div.scrollToTopButton')
    const showBtn = () => {
      window.scrollY > 100
        ? !btn.classList.contains('show') && btn.classList.add('show')
        : btn.classList.contains('show') && btn.classList.remove('show')
    }
    showBtn()
    window.addEventListener('scroll', showBtn)
  })
</script>

<style>
  .scrollToTopButton {
    position: fixed;
    display: flex;
    justify-content: center;
    align-items: center;
    width: 40px;
    height: 40px;
    right: 40px;
    bottom: 40px;

    cursor: pointer;
    border: 1px solid #000000a2;
    color: #000000a2;
    background-color: #ffffff99;
    border-radius: 50%;
    overflow: hidden;
    visibility: hidden;
  }
  .scrollToTopButton.show {
    visibility: visible;
  }
  @media only screen and (max-width: 767px) {
    .scrollToTopButton {
      width: 30px;
      height: 30px;
      right: 20px;
      bottom: 20px;
    }
  }
</style>

</body>
</html>
